# RAG-based Q&A API with Node.js, TypeScript, and OpenAI

このプロジェクトは、**RAG (Retrieval-Augmented Generation)** を使って、独自ドキュメントに基づく質問応答をするデモアプリです。

## ✅ 技術スタック

- Node.js + TypeScript
- Express (API サーバー)
- OpenAI API (Embeddings & Chat)
- ベクトル検索：自前の cosine similarity
- ファイルベースのシンプルなベクトルストレージ（`data.json`）

## 📘 RAG とは？

RAG（Retrieval-Augmented Generation）は、**質問に対して関連する外部ドキュメントから情報を取得し、その情報を使って生成モデルに回答を作らせる手法**です。

この構成により、以下のような活用が可能になります：

- 社内ドキュメントに基づいた質問応答
- 非公開情報を元にした回答
- より正確で根拠のある生成回答

## ✅ 動作手順まとめ（ローカル開発編）

### 1. `.env` ファイルを作成

プロジェクトのルートディレクトリに `.env` ファイルを作り、OpenAI API キーを設定します：

```env
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

### 2. 必要パッケージをインストール

```bash
npm install
```

### 3. ベクトルデータを生成（ドキュメントのチャンク＋ Embedding）

```bash
npx ts-node src/embed.ts
```

これにより、`sample.txt` の内容がチャンク分割され、`data.json` にベクトルが保存されます。

### 4. サーバーを起動

```bash
npx ts-node src/index.ts
```

または（開発中のみ自動再起動にしたい場合）：

```bash
npx ts-node-dev src/index.ts
```

### 5. 質問してみる（curl などで）

```bash
curl -X POST http://localhost:3000/ask \
  -H "Content-Type: application/json" \
  -d '{"question": "富士山の高さは？"}'
```

類似するチャンクが検索され、その情報をもとに ChatGPT が回答を生成します。

## 学習の進捗

| 項目                                 | 状態       | 詳細説明                                                                                      |
| ------------------------------------ | ---------- | --------------------------------------------------------------------------------------------- |
| **1. LLM との基本対話実装**          | できている | OpenAI Chat Completion API で質問応答ができる。API キー設定や基本エラーハンドリング実装済み。 |
| **2. ドキュメントのチャンク分割**    | できている | 任意テキストを適切なチャンクサイズで分割。チャンクサイズ調整で精度改善可能。                  |
| **3. Embedding の活用**              | できている | チャンクを embedding ベクトル化し、JSON に保存可能。                                          |
| **4. ベクトル類似度検索の基礎**      | できている | コサイン類似度で類似チャンク抽出。上位チャンクを質問に利用。                                  |
| **5. RAG ベースの回答生成**          | できている | 類似チャンクを GPT に渡して回答生成。Express API で質問応答を公開。                           |
| **6. 動作検証・デバッグ方法**        | できている | 類似度スコアのログ出力・curl による API 動作確認済み。                                        |
| **7. 商用レベルのスケーラビリティ**  | 未達成     | 大規模ドキュメント対応、ベクトル DB 連携、バッチ処理などは未実装。                            |
| **8. 高度なチャンク分割・前処理**    | 未達成     | セマンティック単位分割、ノイズ除去、テキスト正規化はまだ。                                    |
| **9. 類似度検索の高度化**            | 未達成     | しきい値調整、検索結果の多様性向上などの高度な工夫は未着手。                                  |
| **10. セキュリティ・認証**           | 未達成     | API 認証、アクセス管理、キー管理などの実装はまだ。                                            |
| **11. UI/UX 実装**                   | 未達成     | フロントエンドやリアルタイム表示などはまだ未実装。                                            |
| **12. 運用監視・エラーハンドリング** | 未達成     | ログ集約、アラート、リトライ戦略などの運用面はまだ。                                          |
